phyla <- as.data.frame(phyla)
phyla.rel <- phyla/phyla$rowsum
phyla.rel <- select(phyla.rel,everything(),-starts_with('row'))
phyla.rel.clr <- clr(phyla.rel) %>% as.data.frame(.)
phyla.rel.clr$diet <- ifelse(grepl('U1',row.names(phyla.rel.clr)),'non keto','keto')
##L6 genus
bacteroides.L6 <- norm.L6[grepl('Bacteroides',colnames(norm.L6))]
names(bacteroides.L6)[names(bacteroides.L6) == 'k__Bacteria.p__Bacteroidetes.c__Bacteroidia.o__Bacteroidales.f__Bacteroidaceae.g__Bacteroides'] <- 'Bacteroides'
actinomyces.L6 <- norm.L6[grepl('Actinomyces',colnames(norm.L6))]
names(actinomyces.L6)[names(actinomyces.L6) == 'k__Bacteria.p__Actinobacteria.c__Actinobacteria.o__Actinomycetales.f__Actinomycetaceae.g__Actinomyces'] <- 'Actinomyces'
streptomyces.L6 <- norm.L6[grepl('Streptomyces',colnames(norm.L6))]
names(streptomyces.L6 )[names(streptomyces.L6 ) == 'k__Bacteria.p__Actinobacteria.c__Actinobacteria.o__Actinomycetales.f__Streptomycetaceae.g__Streptomyces'] <- 'Streptomyces'
cardiobacterium.L6 <- norm.L6[grepl('Cardiobacterium',colnames(norm.L6))]
names(cardiobacterium.L6)[names(cardiobacterium.L6) == 'k__Bacteria.p__Proteobacteria.c__Gammaproteobacteria.o__Cardiobacteriales.f__Cardiobacteriaceae.g__Cardiobacterium'] <- 'Cardiobacterium'
# names(bacteroides.L6)[names(bacteroides.L6) == 'k__Bacteria.p__Tenericutes.c__RF3.o__ML615J.28.f__.g__'] <- 'Tenericutes spp.'
buty.L6 <- norm.L6[grepl('Butyrivibrio',colnames(norm.L6))]
names(buty.L6)[names(buty.L6) == 'k__Bacteria.p__Firmicutes.c__Clostridia.o__Clostridiales.f__Lachnospiraceae.g__Butyrivibrio'] <- 'Butyrivibrio'
clost.L6 <- norm.L6[grepl('Clostridiales._',colnames(norm.L6))]
names(clost.L6)[names(clost.L6) == 'k__Bacteria.p__Firmicutes.c__Clostridia.o__Clostridiales.__.__'] <- 'Clostridiales'
genus <- merge(bacteroides.L6,buty.L6,by = 'row.names') %>% column_to_rownames(.,'Row.names') %>% merge(.,clost.L6,by = 'row.names') %>% column_to_rownames(.,'Row.names') %>% merge(.,actinomyces.L6,by = 'row.names') %>% column_to_rownames(.,'Row.names') %>%
merge(.,streptomyces.L6,by = 'row.names') %>% column_to_rownames(.,'Row.names') %>%
merge(.,cardiobacterium.L6,by = 'row.names') %>% column_to_rownames(.,'Row.names')
genus$diet <- ifelse(grepl('U1',row.names(genus)),'non keto','keto')
##L7 specy
specy <- select(norm.L7,ends_with(c('pallens','bacilliformis','faecis','_aeria','catus','_obeum','bifidum')))
colnames(specy) <- c('Prevotella pallens','Neisseria bacilliformis','Roseburia faecis','Rothia aeria','Coprococcus catus','Blautia obeum','Bifidobacterium bifidum')
specy$diet <- ifelse(grepl('U1',row.names(specy)),'non keto','keto')
##plots
symnum.args <- list(cutpoints = c(0, 0.0001, 0.001, 0.01, 0.05, 1), symbols = c("****", "***", "**", "*", "ns"))
#phyla.rel.clr
firm <- ggplot(phyla.rel.clr,aes(x = diet,y = Firmicutes)) +
geom_boxplot()+geom_jitter(shape = 21)+ stat_compare_means(comparison = list(c('non keto','keto')),hide.ns = FALSE,vjust = 1.5,symnum.args = symnum.args)
bact <- ggplot(phyla.rel.clr,aes(x = diet,y = Bacteroidetes)) +
geom_boxplot()+geom_jitter(shape = 21)+ stat_compare_means(comparison = list(c('non keto','keto')),hide.ns = FALSE,vjust = 1.5,symnum.args = symnum.args)
bact.firm <- ggscatter(phyla.rel.clr,x='Bacteroidetes',y='Firmicutes',
add = 'reg.line',conf.int = TRUE,
cor.coef = TRUE,cor.method = 'spearman')
act <- ggplot(phyla.rel.clr,aes(x = diet,y = Actinobacteria)) +
geom_boxplot()+geom_jitter(shape = 21)+ stat_compare_means(comparison = list(c('non keto','keto')),hide.ns = FALSE,vjust = 1.5,symnum.args = symnum.args)
#specy
roseburia <- ggplot(specy,aes(x = diet,y = `Roseburia faecis`)) +
geom_boxplot()+geom_jitter(shape = 21)+ stat_compare_means(comparison = list(c('non keto','keto')),hide.ns = FALSE,vjust = 1.5,symnum.args = symnum.args)+theme(axis.title.y = element_text(size = 8))
prevotella <- ggplot(specy,aes(x = diet,y = `Prevotella pallens`)) +
geom_boxplot()+geom_jitter(shape = 21)+ stat_compare_means(comparison = list(c('non keto','keto')),hide.ns = FALSE,vjust = 1.5,symnum.args = symnum.args)+theme(axis.title.y = element_text(size = 8))
coprococcus <- ggplot(specy,aes(x = diet,y = `Coprococcus catus`)) +
geom_boxplot()+geom_jitter(shape = 21)+ stat_compare_means(comparison = list(c('non keto','keto')),hide.ns = FALSE,vjust = 1.5,symnum.args = symnum.args)+theme(axis.title.y = element_text(size = 8))
neisseria <- ggplot(specy,aes(x = diet,y = `Neisseria bacilliformis`)) +
geom_boxplot()+geom_jitter(shape = 21)+ stat_compare_means(comparison = list(c('non keto','keto')),hide.ns = FALSE,vjust = 1.5,symnum.args = symnum.args)+theme(axis.title.y = element_text(size = 8))
blautia <- ggplot(specy,aes(x = diet,y = `Blautia obeum`)) +
geom_boxplot()+geom_jitter(shape = 21)+ stat_compare_means(comparison = list(c('non keto','keto')),hide.ns = FALSE,vjust = 1.5,symnum.args = symnum.args)+theme(axis.title.y = element_text(size = 8))
rothia <- ggplot(specy,aes(x = diet,y = `Rothia aeria`)) +
geom_boxplot()+geom_jitter(shape = 21)+ stat_compare_means(comparison = list(c('non keto','keto')),hide.ns = FALSE,vjust = 1.5,symnum.args = symnum.args)+theme(axis.title.y = element_text(size = 8))
bifidobacterium <- ggplot(specy,aes(x = diet,y = `Bifidobacterium bifidum`)) +
geom_boxplot()+geom_jitter(shape = 21)+ stat_compare_means(comparison = list(c('non keto','keto')),hide.ns = FALSE,vjust = 1.5,symnum.args = symnum.args)+theme(axis.title.y = element_text(size = 8))
#genus
actinomyces <- ggplot(genus,aes(x = diet,y = `Actinomyces`)) +
geom_boxplot()+geom_jitter(shape = 21)+ stat_compare_means(comparison = list(c('non keto','keto')),hide.ns = FALSE,vjust = 1.5,symnum.args = symnum.args)
butyrivibrio <- ggplot(genus,aes(x = diet,y = `Butyrivibrio`)) +
geom_boxplot()+geom_jitter(shape = 21)+ stat_compare_means(comparison = list(c('non keto','keto')),hide.ns = FALSE,vjust = 1.5,symnum.args = symnum.args)
clostridiales <- ggplot(genus,aes(x = diet,y = `Clostridiales`)) +
geom_boxplot()+geom_jitter(shape = 21)+ stat_compare_means(comparison = list(c('non keto','keto')),hide.ns = FALSE,vjust = 1.5,symnum.args = symnum.args)
streptomyces <- ggplot(genus,aes(x = diet,y = `Streptomyces`)) +
geom_boxplot()+geom_jitter(shape = 21)+ stat_compare_means(comparison = list(c('non keto','keto')),hide.ns = FALSE,vjust = 1.5,symnum.args = symnum.args)
bacteroides <- ggplot(genus,aes(x = diet,y = `Bacteroides`)) +
geom_boxplot()+geom_jitter(shape = 21)+ stat_compare_means(comparison = list(c('non keto','keto')),hide.ns = FALSE,vjust = 1.5,symnum.args = symnum.args)
cardiobacterium <- ggplot(genus,aes(x = diet,y = `Cardiobacterium`)) +
geom_boxplot()+geom_jitter(shape = 21)+ stat_compare_means(comparison = list(c('non keto','keto')),hide.ns = FALSE,vjust = 1.5,symnum.args = symnum.args)
# pdf(paste0(output_dir2,'rarefied.abundances.pdf'))
ggarrange(firm,bact,act,bact.firm,ncol = 2,nrow = 2)
ggarrange(roseburia,prevotella,neisseria,rothia,bifidobacterium,coprococcus,blautia,ncol = 2, nrow = 4, labels = c('A','B','C','D','E','F','G'))
ggarrange(bacteroides,butyrivibrio,clostridiales,cardiobacterium,actinomyces,streptomyces,ncol = 2, nrow = 3, labels = c('H','I','J','K','L','M'))
# dev.off()
phyla.U1 <- phyla.rel.clr[grepl('U1',row.names(phyla.rel.clr)),]
phyla.U2 <- phyla.rel.clr[grepl('U2',row.names(phyla.rel.clr)),]
specy.U1 <- specy[grepl('U1',row.names(specy)),]
specy.U2 <- specy[grepl('U2',row.names(specy)),]
genus.U1 <- genus[grepl('U1',row.names(genus)),]
genus.U2 <- genus[grepl('U2',row.names(genus)),]
genus.U2
df <- dplyr::select(genus.U2,everything(),-starts_with(c('diet')))
summary <- sapply(df,FUN = function(c){
summary(c)
})
sd <- sapply(df,FUN = function(c){
sd(c)
})
df
summary
sd
df <- dplyr::select(genus.U1,everything(),-starts_with(c('diet')))
summary <- sapply(df,FUN = function(c){
summary(c)
})
sd <- sapply(df,FUN = function(c){
sd(c)
})
df <- dplyr::select(genus.U1,everything(),-starts_with(c('diet')))
summary <- sapply(df,FUN = function(c){
summary(c)
})
sd <- sapply(df,FUN = function(c){
sd(c)
})
summary
sd
library(tidyverse)
library(ggplot2)
library(gplots)
output_dir = '../results/'
data_dir = '../data/'
table_dir = paste0(data_dir, 'tables/')
biom_dir = paste0(data_dir,'silva.feces/')
output_heatmap = paste0(output_dir,'sig.heatmaps/')
dir.create(output_dir)
dir.create(table_dir)
##nutrients
nutr.L6 <- read_tsv(paste0(table_dir,'corr.nutr.biom.L6.tsv'))
nutr.L6.U1 <- read_tsv(paste0(table_dir,'corr.nutr.biom.L6.U1.tsv'))
nutr.L6.U2 <- read_tsv(paste0(table_dir,'corr.nutr.biom.L6.U2.tsv'))
nutr.L7 <- read_tsv(paste0(table_dir,'corr.nutr.biom.L7.tsv'))
nutr.L7.U1 <- read_tsv(paste0(table_dir,'corr.nutr.biom.L7.U1.tsv'))
nutr.L7.U2 <- read_tsv(paste0(table_dir,'corr.nutr.biom.L7.U2.tsv'))
##convclust
conv.L6 <- read_tsv(paste0(table_dir,'corr.convclust.biom.L6.tsv'))
conv.L7 <- read_tsv(paste0(table_dir,'corr.convclust.biom.L7.tsv'))
conv.L6.U1 <- read_tsv(paste0(table_dir,'corr.convclust.biom.L6.U1.tsv'))
conv.L6.U2 <- read_tsv(paste0(table_dir,'corr.convclust.biom.L6.U2.tsv'))
conv.L7.U1 <- read_tsv(paste0(table_dir,'corr.convclust.biom.L7.U1.tsv'))
conv.L7.U2 <- read_tsv(paste0(table_dir,'corr.convclust.biom.L7.U2.tsv'))
##nutclust
nutclust.L6 <- read_tsv(paste0(table_dir,'corr.nutclust.biom.L6.tsv'))
nutclust.L7 <- read_tsv(paste0(table_dir,'corr.nutclust.biom.L7.tsv'))
nutclust.L6.U1 <- read_tsv(paste0(table_dir,'corr.nutclust.biom.L6.U1.tsv'))
nutclust.L6.U2 <- read_tsv(paste0(table_dir,'corr.nutclust.biom.L6.U2.tsv'))
nutclust.L7.U1 <- read_tsv(paste0(table_dir,'corr.nutclust.biom.L7.U1.tsv'))
nutclust.L7.U2 <- read_tsv(paste0(table_dir,'corr.nutclust.biom.L7.U2.tsv'))
##family level
cor.test.family <- read_tsv(paste0(table_dir,'rarefied.corr.nutr.family.tsv'))
cor.test.conv <- read_tsv(paste0(table_dir,'corr.convclust.family.tsv'))
cor.test.nutr <- read_tsv(paste0(table_dir,'rarefied.corr.nutclust.family.tsv'))
View(nutr.L6)
nutr.L6.sub <- nutr.L6  %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('p.adj.log')) %>% pivot_wider(.,names_from = 'genus',values_from = 'estimate') %>%
column_to_rownames(.,'nutrient') %>% data.matrix(.)
View(nutr.L6)
nutr.L6 <- nutr.L6 %>% distinct(.)
nutr.L6.sig <- filter(nutr.L6,nutr.L6$estimate >= 0.35 | nutr.L6$estimate <= -0.35)
nutr.L6.sig <- nutr.L6.sig %>% as.data.frame() %>% filter(nutr.L6.sig$p.adj.log >= -log10(0.05))
View(nutr.L6.sig)
library(tidyverse)
library(ggplot2)
library(gplots)
output_dir = '../results/'
data_dir = '../data/'
table_dir = paste0(data_dir, 'tables/')
biom_dir = paste0(data_dir,'silva.feces/')
output_heatmap = paste0(output_dir,'sig.heatmaps/')
dir.create(output_dir)
dir.create(table_dir)
##nutrients
nutr.L6 <- read_tsv(paste0(table_dir,'corr.nutr.biom.L6.tsv'))
nutr.L6.U1 <- read_tsv(paste0(table_dir,'corr.nutr.biom.L6.U1.tsv'))
nutr.L6.U2 <- read_tsv(paste0(table_dir,'corr.nutr.biom.L6.U2.tsv'))
nutr.L7 <- read_tsv(paste0(table_dir,'corr.nutr.biom.L7.tsv'))
nutr.L7.U1 <- read_tsv(paste0(table_dir,'corr.nutr.biom.L7.U1.tsv'))
nutr.L7.U2 <- read_tsv(paste0(table_dir,'corr.nutr.biom.L7.U2.tsv'))
##convclust
conv.L6 <- read_tsv(paste0(table_dir,'corr.convclust.biom.L6.tsv'))
conv.L7 <- read_tsv(paste0(table_dir,'corr.convclust.biom.L7.tsv'))
conv.L6.U1 <- read_tsv(paste0(table_dir,'corr.convclust.biom.L6.U1.tsv'))
conv.L6.U2 <- read_tsv(paste0(table_dir,'corr.convclust.biom.L6.U2.tsv'))
conv.L7.U1 <- read_tsv(paste0(table_dir,'corr.convclust.biom.L7.U1.tsv'))
conv.L7.U2 <- read_tsv(paste0(table_dir,'corr.convclust.biom.L7.U2.tsv'))
##nutclust
nutclust.L6 <- read_tsv(paste0(table_dir,'corr.nutclust.biom.L6.tsv'))
nutclust.L7 <- read_tsv(paste0(table_dir,'corr.nutclust.biom.L7.tsv'))
nutclust.L6.U1 <- read_tsv(paste0(table_dir,'corr.nutclust.biom.L6.U1.tsv'))
nutclust.L6.U2 <- read_tsv(paste0(table_dir,'corr.nutclust.biom.L6.U2.tsv'))
nutclust.L7.U1 <- read_tsv(paste0(table_dir,'corr.nutclust.biom.L7.U1.tsv'))
nutclust.L7.U2 <- read_tsv(paste0(table_dir,'corr.nutclust.biom.L7.U2.tsv'))
##family level
cor.test.family <- read_tsv(paste0(table_dir,'rarefied.corr.nutr.family.tsv'))
cor.test.conv <- read_tsv(paste0(table_dir,'corr.convclust.family.tsv'))
cor.test.nutr <- read_tsv(paste0(table_dir,'rarefied.corr.nutclust.family.tsv'))
##L6
nutr.L6.sub <- nutr.L6  %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('p.adj.log')) %>% pivot_wider(.,names_from = 'genus',values_from = 'estimate') %>%
column_to_rownames(.,'nutrient') %>% data.matrix(.)
nutr.L6.sub2 <- nutr.L6 %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('estimate')) %>% pivot_wider(.,names_from = 'genus',values_from = 'p.adj.log') %>%
column_to_rownames(.,'nutrient') %>% data.matrix(.)
nutr.L6.sub2 <- ifelse(nutr.L6.sub2 >= -log10(0.05),'*','')
nutr.L6.U1.sub <- nutr.L6.U1  %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('p.adj.log')) %>% pivot_wider(.,names_from = 'genus',values_from = 'estimate') %>%
column_to_rownames(.,'nutrient') %>% data.matrix(.)
nutr.L6.U1.sub2 <- nutr.L6.U1 %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('estimate')) %>% pivot_wider(.,names_from = 'genus',values_from = 'p.adj.log') %>%
column_to_rownames(.,'nutrient') %>% data.matrix(.)
nutr.L6.U1.sub2 <- ifelse(nutr.L6.U1.sub2 >= -log10(0.05),'*','')
nutr.L6.U2.sub <- nutr.L6.U2  %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('p.adj.log')) %>% pivot_wider(.,names_from = 'genus',values_from = 'estimate') %>%
column_to_rownames(.,'nutrient') %>% data.matrix(.)
nutr.L6.U2.sub2 <- nutr.L6.U2 %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('estimate')) %>% pivot_wider(.,names_from = 'genus',values_from = 'p.adj.log') %>%
column_to_rownames(.,'nutrient') %>% data.matrix(.)
nutr.L6.U2.sub2 <- ifelse(nutr.L6.U2.sub2 >= -log10(0.05),'*','')
##L7
nutr.L7.sub <- nutr.L7  %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('p.adj.log')) %>% pivot_wider(.,names_from = 'specy',values_from = 'estimate') %>%
column_to_rownames(.,'nutrient') %>% data.matrix(.)
nutr.L7.sub2 <- nutr.L7 %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('estimate')) %>% pivot_wider(.,names_from = 'specy',values_from = 'p.adj.log') %>%
column_to_rownames(.,'nutrient') %>% data.matrix(.)
nutr.L7.sub2 <- ifelse(nutr.L7.sub2 >= -log10(0.05),'*','')
nutr.L7.U1.sub <- nutr.L7.U1  %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('p.adj.log')) %>% pivot_wider(.,names_from = 'genus',values_from = 'estimate') %>%
column_to_rownames(.,'nutrient') %>% data.matrix(.)
nutr.L7.U1.sub2 <- nutr.L7.U1 %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('estimate')) %>% pivot_wider(.,names_from = 'genus',values_from = 'p.adj.log') %>%
column_to_rownames(.,'nutrient') %>% data.matrix(.)
nutr.L7.U1.sub2 <- ifelse(nutr.L7.U1.sub2 >= -log10(0.05),'*','')
nutr.L7.U2.sub <- nutr.L7.U2  %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('p.adj.log')) %>% pivot_wider(.,names_from = 'specy',values_from = 'estimate') %>%
column_to_rownames(.,'nutrient') %>% data.matrix(.)
nutr.L7.U2.sub2 <- nutr.L7.U2 %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('estimate')) %>% pivot_wider(.,names_from = 'specy',values_from = 'p.adj.log') %>%
column_to_rownames(.,'nutrient') %>% data.matrix(.)
nutr.L7.U2.sub2 <- ifelse(nutr.L7.U2.sub2 >= -log10(0.05),'*','')
##only spearman not -0.35 until 0.35, finding out interesting taxa
#L6
nutr.L6 <- nutr.L6 %>% distinct(.)
nutr.L6.sig <- filter(nutr.L6,nutr.L6$estimate >= 0.35 | nutr.L6$estimate <= -0.35)
nutr.L6.sig <- nutr.L6.sig %>% as.data.frame() %>% filter(nutr.L6.sig$p.adj.log >= -log10(0.05))
# nutr.L6.sig <- nutr.L6[nutr.L6$estimate >= 0.2 | nutr.L6$estimate <= -0.2,]
# nutr.L6.sig.min <- nutr.L6[order(nutr.L6$estimate ),][1:30,]
# nutr.L6.sig.plus <- nutr.L6[order(-nutr.L6$estimate ),][1:30,]
# nutr.L6.sig <- rbind(nutr.L6.sig.min,nutr.L6.sig.plus) %>% distinct(.)
write_tsv(nutr.L6.sig,paste0(table_dir,'nutrients.L6.corr.tsv'))
#subset of high correlations with interesting taxa
nutr.L6.sig <- nutr.L6[grepl('_Actinomyces',nutr.L6$genus) | grepl('_Streptomyces',nutr.L6$genus) | grepl('Clostridiales._',nutr.L6$genus)| grepl('Butyrivibrio',nutr.L6$genus)| grepl('Bacteroides',nutr.L6$genus) ,]
nutr.L6.sig <- nutr.L6.sig[grepl('Gesättigte Fettsäuren',nutr.L6.sig$nutrient) |grepl('ungesättigte Fettsäuren',nutr.L6.sig$nutrient)|grepl('Glucose',nutr.L6.sig$nutrient)| grepl('Energie,',nutr.L6.sig$nutrient) | grepl('Polysaccharide',nutr.L6.sig$nutrient)|grepl('Essentielle Aminosäuren',nutr.L6.sig$nutrient)| grepl('Protein',nutr.L6.sig$nutrient),]
# nutr.L6.sig <- nutr.L6.sig[!grepl('Vitamin',nutr.L6.sig$nutrient) & !grepl('Kalium',nutr.L6.sig$nutrient) &!grepl('Iodid',nutr.L6.sig$nutrient)& !grepl('Kupfer',nutr.L6.sig$nutrient)& !grepl('asser',nutr.L6.sig$nutrient)& !grepl('Fluorid',nutr.L6.sig$nutrient)& !grepl('Sorbit',nutr.L6.sig$nutrient)& !grepl('Schwefel',nutr.L6.sig$nutrient)& !grepl('Chlorid',nutr.L6.sig$nutrient)& !grepl('Zink',nutr.L6.sig$nutrient)& !grepl('Mangan',nutr.L6.sig$nutrient)& !grepl('ium',nutr.L6.sig$nutrient)& !grepl('Eisen',nutr.L6.sig$nutrient)& !grepl('Phosphor',nutr.L6.sig$nutrient)& !grepl('Mannit',nutr.L6.sig$nutrient)& !grepl('Harn',nutr.L6.sig$nutrient)& !grepl('Purin',nutr.L6.sig$nutrient)& !grepl('Zuckeralkohol',nutr.L6.sig$nutrient)& !grepl('Alkohol',nutr.L6.sig$nutrient)& !grepl('Xylit',nutr.L6.sig$nutrient)& !grepl('Gesamt',nutr.L6.sig$nutrient)& !grepl('Cellulose',nutr.L6.sig$nutrient)& !grepl('Ballast',nutr.L6.sig$nutrient)& !grepl('Broteinheiten',nutr.L6.sig$nutrient)&!grepl('Glycerin',nutr.L6.sig$nutrient)&!grepl('Uron',nutr.L6.sig$nutrient)&  !grepl('Zuckeralkohol',nutr.L6.sig$nutrient)&!grepl('Alkohol',nutr.L6.sig$nutrient),]
nutr.L6.sig.sub <- nutr.L6.sig  %>%  dplyr::select(.,everything(),-starts_with('p.adj.log'))  %>% pivot_wider(.,names_from = 'genus',values_from = 'estimate') %>%
column_to_rownames(.,'nutrient') %>% data.matrix(.)
nutr.L6.sig.sub[is.na(nutr.L6.sig.sub)] <- 0
nutr.L6.sig.sub2 <- nutr.L6.sig  %>%  dplyr::select(.,everything(),-starts_with('estimate'))%>% distinct(.) %>% pivot_wider(.,names_from = 'genus',values_from = 'p.adj.log') %>%
column_to_rownames(.,'nutrient') %>% data.matrix(.)
nutr.L6.sig.sub2 <- ifelse(nutr.L6.sig.sub2 >= -log10(0.05),'*','')
##U1 with sub of taxa and nutrients
nutr.L6.U1 <- nutr.L6.U1 %>% distinct(.)
nutr.L6.sig.U1 <- nutr.L6.U1[grepl('_Actinomyces',nutr.L6.U1$genus) | grepl('_Streptomyces',nutr.L6.U1$genus) | grepl('Clostridiales._',nutr.L6.U1$genus)| grepl('Butyrivibrio',nutr.L6.U1$genus)| grepl('Bacteroides',nutr.L6.U1$genus),]
nutr.L6.sig.U1 <- nutr.L6.sig.U1[grepl('Gesättigte Fettsäuren',nutr.L6.sig.U1$nutrient) |grepl('ungesättigte Fettsäuren',nutr.L6.sig.U1$nutrient)|grepl('Glucose',nutr.L6.sig.U1$nutrient)| grepl('Energie,',nutr.L6.sig.U1$nutrient) | grepl('Polysaccharide',nutr.L6.sig.U1$nutrient)|grepl('Essentielle Aminosäuren',nutr.L6.sig.U1$nutrient)| grepl('Protein',nutr.L6.sig.U1$nutrient),]
# nutr.L6.sig.U1 <- nutr.L6.sig.U1[!grepl('Vitamin',nutr.L6.sig.U1$nutrient) & !grepl('Kalium',nutr.L6.sig.U1$nutrient) &!grepl('Iodid',nutr.L6.sig.U1$nutrient)& !grepl('Kupfer',nutr.L6.sig.U1$nutrient)& !grepl('asser',nutr.L6.sig.U1$nutrient)& !grepl('Fluorid',nutr.L6.sig.U1$nutrient)& !grepl('Sorbit',nutr.L6.sig.U1$nutrient)& !grepl('Schwefel',nutr.L6.sig.U1$nutrient)& !grepl('Chlorid',nutr.L6.sig.U1$nutrient)& !grepl('Zink',nutr.L6.sig.U1$nutrient)& !grepl('Mangan',nutr.L6.sig.U1$nutrient)& !grepl('ium',nutr.L6.sig.U1$nutrient)& !grepl('Eisen',nutr.L6.sig.U1$nutrient)& !grepl('Phosphor',nutr.L6.sig.U1$nutrient)& !grepl('Mannit',nutr.L6.sig.U1$nutrient)& !grepl('Harn',nutr.L6.sig.U1$nutrient)& !grepl('Purin',nutr.L6.sig.U1$nutrient)& !grepl('Zuckeralkohol',nutr.L6.sig.U1$nutrient)&!grepl('Xylit',nutr.L6.sig$nutrient)& !grepl('Gesamt',nutr.L6.sig$nutrient)& !grepl('Cellulose',nutr.L6.sig$nutrient)& !grepl('Ballast',nutr.L6.sig$nutrient)& !grepl('Broteinheiten',nutr.L6.sig$nutrient)&!grepl('Glycerin',nutr.L6.sig$nutrient)&!grepl('Uron',nutr.L6.sig$nutrient)&  !grepl('Alkohol',nutr.L6.sig.U1$nutrient),]
# nutr.L6.U1.sig <- nutr.L6.U1[nutr.L6.U1$estimate >= 0.2 | nutr.L6.U1$estimate <= -0.2,]
# nutr.L6.U1.sig <- nutr.L6.U1.sig[order(-nutr.L6.U1.sig$estimate ),][1:50,]
nutr.L6.U1.sig.sub <- nutr.L6.sig.U1 %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('p.adj.log'))  %>% pivot_wider(.,names_from = 'genus',values_from = 'estimate') %>%
column_to_rownames(.,'nutrient') %>% data.matrix(.)
nutr.L6.U1.sig.sub[is.na(nutr.L6.U1.sig.sub)] <- 0
nutr.L6.U1.sig.sub2 <- nutr.L6.sig.U1  %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('estimate'))%>% distinct(.) %>% pivot_wider(.,names_from = 'genus',values_from = 'p.adj.log') %>%
column_to_rownames(.,'nutrient') %>% data.matrix(.)
nutr.L6.U1.sig.sub2 <- ifelse(nutr.L6.U1.sig.sub2 >= -log10(0.05),'*','')
##U2 with sub of taxa and nutrients
nutr.L6.U2 <- nutr.L6.U2 %>% distinct(.)
nutr.L6.sig.U2 <- nutr.L6.U2[grepl('_Actinomyces',nutr.L6.U2$genus) | grepl('_Streptomyces',nutr.L6.U2$genus) | grepl('Clostridiales._',nutr.L6.U2$genus)| grepl('Butyrivibrio',nutr.L6.U2$genus)| grepl('Bacteroides',nutr.L6.U2$genus),]
nutr.L6.sig.U2 <- nutr.L6.sig.U2[grepl('Gesättigte Fettsäuren',nutr.L6.sig.U2$nutrient) |grepl('ungesättigte Fettsäuren',nutr.L6.sig.U2$nutrient)|grepl('Glucose',nutr.L6.sig.U2$nutrient)| grepl('Energie,',nutr.L6.sig.U2$nutrient) | grepl('Polysaccharide',nutr.L6.sig.U2$nutrient)|grepl('Essentielle Aminosäuren',nutr.L6.sig.U2$nutrient)| grepl('Protein',nutr.L6.sig.U2$nutrient),]
# nutr.L6.sig.U2 <- nutr.L6.sig.U2[!grepl('Vitamin',nutr.L6.sig.U2$nutrient) & !grepl('Kalium',nutr.L6.sig.U2$nutrient) &!grepl('Iodid',nutr.L6.sig.U2$nutrient)& !grepl('Kupfer',nutr.L6.sig.U2$nutrient)& !grepl('asser',nutr.L6.sig.U2$nutrient)& !grepl('Fluorid',nutr.L6.sig.U2$nutrient)& !grepl('Sorbit',nutr.L6.sig.U2$nutrient)& !grepl('Schwefel',nutr.L6.sig.U2$nutrient)& !grepl('Chlorid',nutr.L6.sig.U2$nutrient)& !grepl('Zink',nutr.L6.sig.U2$nutrient)& !grepl('Mangan',nutr.L6.sig.U2$nutrient)& !grepl('ium',nutr.L6.sig.U2$nutrient)& !grepl('Eisen',nutr.L6.sig.U2$nutrient)& !grepl('Phosphor',nutr.L6.sig.U2$nutrient)& !grepl('Mannit',nutr.L6.sig.U2$nutrient)& !grepl('Harn',nutr.L6.sig.U2$nutrient)& !grepl('Purin',nutr.L6.sig.U2$nutrient)& !grepl('Zuckeralkohol',nutr.L6.sig.U2$nutrient)&!grepl('Xylit',nutr.L6.sig$nutrient)& !grepl('Gesamt',nutr.L6.sig$nutrient)& !grepl('Cellulose',nutr.L6.sig$nutrient)& !grepl('Ballast',nutr.L6.sig$nutrient)& !grepl('Broteinheiten',nutr.L6.sig$nutrient)&!grepl('Glycerin',nutr.L6.sig$nutrient)&!grepl('Uron',nutr.L6.sig$nutrient)&  !grepl('Alkohol',nutr.L6.sig.U2$nutrient),]
# nutr.L6.U2.sig <- nutr.L6.U2[nutr.L6.U2$estimate >= 0.2 | nutr.L6.U2$estimate <= -0.2,]
# nutr.L6.U2.sig <- nutr.L6.U2.sig[order(-nutr.L6.U2.sig$estimate ),][1:50,]
nutr.L6.U2.sig.sub <- nutr.L6.sig.U2 %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('p.adj.log'))  %>% pivot_wider(.,names_from = 'genus',values_from = 'estimate') %>%
column_to_rownames(.,'nutrient') %>% data.matrix(.)
nutr.L6.U2.sig.sub[is.na(nutr.L6.U2.sig.sub)] <- 0
nutr.L6.U2.sig.sub2 <- nutr.L6.sig.U2  %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('estimate'))%>% distinct(.) %>% pivot_wider(.,names_from = 'genus',values_from = 'p.adj.log') %>%
column_to_rownames(.,'nutrient') %>% data.matrix(.)
nutr.L6.U2.sig.sub2 <- ifelse(nutr.L6.U2.sig.sub2 >= -log10(0.05),'*','')
##only spearman not -0.35 until 0.35, finding o ut interesting taxa
#L7
nutr.L7 <- nutr.L7 %>% distinct(.)
nutr.L7.sig <- nutr.L7[nutr.L7$estimate >= 0.35 | nutr.L7$estimate <= -0.35,]
nutr.L7.sig <- nutr.L7[nutr.L7$p.adj.log >= -log10(0.05),]
# nutr.L7.sig.min <- nutr.L7.sig[order(nutr.L7.sig$estimate ),][1:30,]
# nutr.L7.sig.plus <- nutr.L7.sig[order(-nutr.L7.sig$estimate ),][1:30,]
# nutr.L7.sig <- rbind(nutr.L7.sig.min,nutr.L7.sig.plus) %>% distinct(.)
write_tsv(nutr.L7.sig,paste0(table_dir,'nutrients.L7.corr.tsv'))
nutr.L7.sig <- nutr.L7[grepl('pallens',nutr.L7$specy) | grepl('bacilliformis',nutr.L7$specy)| grepl('faecis',nutr.L7$specy)|  grepl('bifidum',nutr.L7$specy)| grepl('catus',nutr.L7$specy)| grepl('_obeum',nutr.L7$specy) ,]
nutr.L7.sig <- nutr.L7.sig[grepl('Gesättigte Fettsäuren',nutr.L7.sig$nutrient) |grepl('ungesättigte Fettsäuren',nutr.L7.sig$nutrient)|grepl('Glucose',nutr.L7.sig$nutrient)| grepl('Energie,',nutr.L7.sig$nutrient) | grepl('Polysaccharide',nutr.L7.sig$nutrient)|grepl('Essentielle Aminosäuren',nutr.L7.sig$nutrient)| grepl('Protein',nutr.L7.sig$nutrient),]
# nutr.L7.sig <- nutr.L7.sig[!grepl('Vitamin',nutr.L7.sig$nutrient) & !grepl('Kalium',nutr.L7.sig$nutrient) &!grepl('Iodid',nutr.L7.sig$nutrient)& !grepl('Kupfer',nutr.L7.sig$nutrient)& !grepl('asser',nutr.L7.sig$nutrient)& !grepl('Fluorid',nutr.L7.sig$nutrient)& !grepl('Sorbit',nutr.L7.sig$nutrient)& !grepl('Schwefel',nutr.L7.sig$nutrient)& !grepl('Chlorid',nutr.L7.sig$nutrient)& !grepl('Zink',nutr.L7.sig$nutrient)& !grepl('Mangan',nutr.L7.sig$nutrient)& !grepl('ium',nutr.L7.sig$nutrient)& !grepl('Eisen',nutr.L7.sig$nutrient)& !grepl('Phosphor',nutr.L7.sig$nutrient)& !grepl('Mannit',nutr.L7.sig$nutrient)& !grepl('Harn',nutr.L7.sig$nutrient)& !grepl('Purin',nutr.L7.sig$nutrient)&!grepl('Xylit',nutr.L6.sig$nutrient)& !grepl('Gesamt',nutr.L6.sig$nutrient)& !grepl('Cellulose',nutr.L6.sig$nutrient)& !grepl('Ballast',nutr.L6.sig$nutrient)& !grepl('Zuckeralkohol',nutr.L7.sig$nutrient)&!grepl('Broteinheiten',nutr.L6.sig$nutrient)&!grepl('Glycerin',nutr.L6.sig$nutrient)&!grepl('Uron',nutr.L6.sig$nutrient)&   !grepl('Alkohol',nutr.L7.sig$nutrient),]
nutr.L7.sig.sub <- nutr.L7.sig %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('p.adj.log'))  %>% pivot_wider(.,names_from = 'specy',values_from = 'estimate') %>%
column_to_rownames(.,'nutrient') %>% data.matrix(.)
nutr.L7.sig.sub[is.na(nutr.L7.sig.sub)] <- 0
nutr.L7.sig.sub2 <- nutr.L7.sig  %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('estimate'))%>% distinct(.) %>% pivot_wider(.,names_from = 'specy',values_from = 'p.adj.log') %>%
column_to_rownames(.,'nutrient') %>% data.matrix(.)
nutr.L7.sig.sub2 <- ifelse(nutr.L7.sig.sub2 >= -log10(0.05),'*','')
#U1 with subset of taxa and nutrients
nutr.L7.U1 <- nutr.L7.U1 %>% distinct(.)
nutr.L7.U1.sig <- nutr.L7.U1[grepl('pallens',nutr.L7.U1$genus) | grepl('bacilliformis',nutr.L7.U1$genus)| grepl('faecis',nutr.L7.U1$genus)| grepl('bifidum',nutr.L7.U1$genus)| grepl('catus',nutr.L7.U1$genus)| grepl('_obeum',nutr.L7.U1$genus) ,]
nutr.L7.U1.sig <- nutr.L7.U1.sig[grepl('Gesättigte Fettsäuren',nutr.L7.U1.sig$nutrient) |grepl('ungesättigte Fettsäuren',nutr.L7.U1.sig$nutrient)|grepl('Glucose',nutr.L7.U1.sig$nutrient)| grepl('Energie,',nutr.L7.U1.sig$nutrient) | grepl('Polysaccharide',nutr.L7.U1.sig$nutrient)|grepl('Essentielle Aminosäuren',nutr.L7.U1.sig$nutrient)| grepl('Protein',nutr.L7.U1.sig$nutrient),]
# nutr.L7.U1.sig <- nutr.L7.U1.sig[!grepl('Vitamin',nutr.L7.U1.sig$nutrient) & !grepl('Kalium',nutr.L7.U1.sig$nutrient) &!grepl('Iodid',nutr.L7.U1.sig$nutrient)& !grepl('Kupfer',nutr.L7.U1.sig$nutrient)& !grepl('asser',nutr.L7.U1.sig$nutrient)& !grepl('Fluorid',nutr.L7.U1.sig$nutrient)& !grepl('Sorbit',nutr.L7.U1.sig$nutrient)& !grepl('Schwefel',nutr.L7.U1.sig$nutrient)& !grepl('Chlorid',nutr.L7.U1.sig$nutrient)& !grepl('Zink',nutr.L7.U1.sig$nutrient)& !grepl('Mangan',nutr.L7.U1.sig$nutrient)& !grepl('ium',nutr.L7.U1.sig$nutrient)& !grepl('Eisen',nutr.L7.U1.sig$nutrient)& !grepl('Phosphor',nutr.L7.U1.sig$nutrient)& !grepl('Mannit',nutr.L7.U1.sig$nutrient)& !grepl('Harn',nutr.L7.U1.sig$nutrient)& !grepl('Purin',nutr.L7.U1.sig$nutrient)& !grepl('Zuckeralkohol',nutr.L7.U1.sig$nutrient)&!grepl('Xylit',nutr.L6.sig$nutrient)& !grepl('Gesamt',nutr.L6.sig$nutrient)& !grepl('Cellulose',nutr.L6.sig$nutrient)& !grepl('Ballast',nutr.L6.sig$nutrient)& !grepl('Broteinheiten',nutr.L6.sig$nutrient)&!grepl('Glycerin',nutr.L6.sig$nutrient)&!grepl('Uron',nutr.L6.sig$nutrient)&  !grepl('Alkohol',nutr.L7.U1.sig$nutrient),]
# nutr.L7.U1.sig <- nutr.L7.U1[nutr.L7.U1$estimate >= 0.2 | nutr.L7.U1$estimate <= -0.2,]
# nutr.L7.U1.sig <- nutr.L7.U1.sig[order(-nutr.L7.U1.sig$estimate ),][1:50,]
nutr.L7.U1.sig.sub <- nutr.L7.U1.sig %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('p.adj.log'))  %>% pivot_wider(.,names_from = 'genus',values_from = 'estimate') %>%
column_to_rownames(.,'nutrient') %>% data.matrix(.)
nutr.L7.U1.sig.sub[is.na(nutr.L7.U1.sig.sub)] <- 0
nutr.L7.U1.sig.sub2 <- nutr.L7.U1.sig  %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('estimate'))%>% distinct(.) %>% pivot_wider(.,names_from = 'genus',values_from = 'p.adj.log') %>%
column_to_rownames(.,'nutrient') %>% data.matrix(.)
nutr.L7.U1.sig.sub2 <- ifelse(nutr.L7.U1.sig.sub2 >= -log10(0.05),'*','')
#sub of taxa and nutrients
nutr.L7.U2 <- nutr.L7.U2 %>% distinct(.)
nutr.L7.U2.sig <- nutr.L7.U2[grepl('pallens',nutr.L7.U2$specy) | grepl('bacilliformis',nutr.L7.U2$specy)| grepl('faecis',nutr.L7.U2$specy)| grepl('bifidum',nutr.L7.U2$specy)| grepl('catus',nutr.L7.U2$specy)| grepl('_obeum',nutr.L7.U2$specy) ,]
nutr.L7.U2.sig <- nutr.L7.U2.sig[grepl('Gesättigte Fettsäuren',nutr.L7.U2.sig$nutrient) |grepl('ungesättigte Fettsäuren',nutr.L7.U2.sig$nutrient)|grepl('Glucose',nutr.L7.U2.sig$nutrient)| grepl('Energie,',nutr.L7.U2.sig$nutrient) | grepl('Polysaccharide',nutr.L7.U2.sig$nutrient)|grepl('Essentielle Aminosäuren',nutr.L7.U2.sig$nutrient)| grepl('Protein',nutr.L7.U2.sig$nutrient),]
# nutr.L7.U2.sig <- nutr.L7.U2.sig[!grepl('Vitamin',nutr.L7.U2.sig$nutrient) & !grepl('Kalium',nutr.L7.U2.sig$nutrient) &!grepl('Iodid',nutr.L7.U2.sig$nutrient)& !grepl('Kupfer',nutr.L7.U2.sig$nutrient)& !grepl('asser',nutr.L7.U2.sig$nutrient)& !grepl('Fluorid',nutr.L7.U2.sig$nutrient)& !grepl('Sorbit',nutr.L7.U2.sig$nutrient)& !grepl('Schwefel',nutr.L7.U2.sig$nutrient)& !grepl('Chlorid',nutr.L7.U2.sig$nutrient)& !grepl('Zink',nutr.L7.U2.sig$nutrient)& !grepl('Mangan',nutr.L7.U2.sig$nutrient)& !grepl('ium',nutr.L7.U2.sig$nutrient)& !grepl('Eisen',nutr.L7.U2.sig$nutrient)& !grepl('Phosphor',nutr.L7.U2.sig$nutrient)& !grepl('Mannit',nutr.L7.U2.sig$nutrient)& !grepl('Harn',nutr.L7.U2.sig$nutrient)& !grepl('Purin',nutr.L7.U2.sig$nutrient)& !grepl('Zuckeralkohol',nutr.L7.U2.sig$nutrient)&!grepl('Xylit',nutr.L6.sig$nutrient)& !grepl('Gesamt',nutr.L6.sig$nutrient)& !grepl('Cellulose',nutr.L6.sig$nutrient)& !grepl('Ballast',nutr.L6.sig$nutrient)& !grepl('Broteinheiten',nutr.L6.sig$nutrient)&!grepl('Glycerin',nutr.L6.sig$nutrient)&!grepl('Uron',nutr.L6.sig$nutrient)&  !grepl('Alkohol',nutr.L7.U2.sig$nutrient),]
# nutr.L7.U2.sig <- nutr.L7.U2[nutr.L7.U2$estimate >= 0.2 | nutr.L7.U2$estimate <= -0.2,]
# nutr.L7.U2.sig <- nutr.L7.U2.sig[order(-nutr.L7.U2.sig$estimate ),][1:50,]
nutr.L7.U2.sig.sub <- nutr.L7.U2.sig %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('p.adj.log'))  %>% pivot_wider(.,names_from = 'specy',values_from = 'estimate') %>%
column_to_rownames(.,'nutrient') %>% data.matrix(.)
nutr.L7.U2.sig.sub[is.na(nutr.L7.U2.sig.sub)] <- 0
nutr.L7.U2.sig.sub2 <- nutr.L7.U2.sig  %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('estimate'))%>% distinct(.) %>% pivot_wider(.,names_from = 'specy',values_from = 'p.adj.log') %>%
column_to_rownames(.,'nutrient') %>% data.matrix(.)
nutr.L7.U2.sig.sub2 <- ifelse(nutr.L7.U2.sig.sub2 >= -log10(0.05),'*','')
my_palette <- colorRampPalette(c("blue", "white", "red"))(n = 299)
# pdf(paste0(output_heatmap,'21.02_nutrients.rarefied.heatmaps.pdf'))
heatmap.2(nutr.L6.sub,cexRow = .35,cexCol = .4,trace = 'none',key.title = 'Spearman correlation',col = my_palette,keysize = .5,key.par = list(cex=.4) ,notecol = 'black',srtCol = 30,cellnote = nutr.L6.sub2)
nutr.L6.sub
View(nutr.L6.sub)
View(nutr.L6.sub2)
nutr.L6.sub2 <- nutr.L6 %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('estimate')) %>% pivot_wider(.,names_from = 'genus',values_from = 'p.adj.log') %>%
column_to_rownames(.,'nutrient') %>% data.matrix(.)
View(nutr.L6.sub2)
View(nutr.L6.sig)
-log10(0.677)
nutr.L6 <- nutr.L6 %>% distinct(.)
nutr.L6.sig <- filter(nutr.L6,nutr.L6$estimate >= 0.35 | nutr.L6$estimate <= -0.35)
nutr.L6.sig <- nutr.L6.sig %>% as.data.frame() %>% filter(nutr.L6.sig$p.adj.log >= -log10(0.05))
nutr.L6.sig <- nutr.L6[grepl('_Actinomyces',nutr.L6$genus) | grepl('_Streptomyces',nutr.L6$genus) | grepl('Clostridiales._',nutr.L6$genus)| grepl('Butyrivibrio',nutr.L6$genus)| grepl('Bacteroides',nutr.L6$genus) ,]
nutr.L6.sig <- nutr.L6.sig[grepl('Gesättigte Fettsäuren',nutr.L6.sig$nutrient) |grepl('ungesättigte Fettsäuren',nutr.L6.sig$nutrient)|grepl('Glucose',nutr.L6.sig$nutrient)| grepl('Energie,',nutr.L6.sig$nutrient) | grepl('Polysaccharide',nutr.L6.sig$nutrient)|grepl('Essentielle Aminosäuren',nutr.L6.sig$nutrient)| grepl('Protein',nutr.L6.sig$nutrient),]
# nutr.L6.sig <- nutr.L6.sig[!grepl('Vitamin',nutr.L6.sig$nutrient) & !grepl('Kalium',nutr.L6.sig$nutrient) &!grepl('Iodid',nutr.L6.sig$nutrient)& !grepl('Kupfer',nutr.L6.sig$nutrient)& !grepl('asser',nutr.L6.sig$nutrient)& !grepl('Fluorid',nutr.L6.sig$nutrient)& !grepl('Sorbit',nutr.L6.sig$nutrient)& !grepl('Schwefel',nutr.L6.sig$nutrient)& !grepl('Chlorid',nutr.L6.sig$nutrient)& !grepl('Zink',nutr.L6.sig$nutrient)& !grepl('Mangan',nutr.L6.sig$nutrient)& !grepl('ium',nutr.L6.sig$nutrient)& !grepl('Eisen',nutr.L6.sig$nutrient)& !grepl('Phosphor',nutr.L6.sig$nutrient)& !grepl('Mannit',nutr.L6.sig$nutrient)& !grepl('Harn',nutr.L6.sig$nutrient)& !grepl('Purin',nutr.L6.sig$nutrient)& !grepl('Zuckeralkohol',nutr.L6.sig$nutrient)& !grepl('Alkohol',nutr.L6.sig$nutrient)& !grepl('Xylit',nutr.L6.sig$nutrient)& !grepl('Gesamt',nutr.L6.sig$nutrient)& !grepl('Cellulose',nutr.L6.sig$nutrient)& !grepl('Ballast',nutr.L6.sig$nutrient)& !grepl('Broteinheiten',nutr.L6.sig$nutrient)&!grepl('Glycerin',nutr.L6.sig$nutrient)&!grepl('Uron',nutr.L6.sig$nutrient)&  !grepl('Zuckeralkohol',nutr.L6.sig$nutrient)&!grepl('Alkohol',nutr.L6.sig$nutrient),]
View(nutr.L7.sig)
-log10(2,71)
-log10(2.71)
-log10(4)
log10(2.71)
log10(4)
log10(1)
log10(1.9)
-log10(4)
-log10(0.05)
-log10(1.30103)
ln(1.30103)
e^1.10301
-log10(0.0116)
nutclust.L6.sub <- nutclust.L6  %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('p.adj.log')) %>% pivot_wider(.,names_from = 'genus',values_from = 'estimate') %>%
column_to_rownames(.,'clusters') %>% data.matrix(.)
nutclust.L6.sub2 <- nutclust.L6 %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('estimate')) %>% pivot_wider(.,names_from = 'genus',values_from = 'p.adj.log') %>%
column_to_rownames(.,'clusters') %>% data.matrix(.)
nutclust.L6.sub2 <- ifelse(nutclust.L6.sub2 >= -log10(0.05),'*','')
nutclust.L6.U1.sub <- nutclust.L6.U1  %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('p.adj.log')) %>% pivot_wider(.,names_from = 'genus',values_from = 'estimate') %>%
column_to_rownames(.,'cluster') %>% data.matrix(.)
nutclust.L6.U1.sub2 <- nutclust.L6.U1 %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('estimate')) %>% pivot_wider(.,names_from = 'genus',values_from = 'p.adj.log') %>%
column_to_rownames(.,'cluster') %>% data.matrix(.)
nutclust.L6.U1.sub2 <- ifelse(nutclust.L6.U1.sub2 >= -log10(0.05),'*','')
nutclust.L6.U2.sub <- nutclust.L6.U2  %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('p.adj.log')) %>% pivot_wider(.,names_from = 'genus',values_from = 'estimate') %>%
column_to_rownames(.,'cluster') %>% data.matrix(.)
nutclust.L6.U2.sub2 <- nutclust.L6.U2 %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('estimate')) %>% pivot_wider(.,names_from = 'genus',values_from = 'p.adj.log') %>%
column_to_rownames(.,'cluster') %>% data.matrix(.)
nutclust.L6.U2.sub2 <- ifelse(nutclust.L6.U2.sub2 >= -log10(0.05),'*','')
##L7
nutclust.L7.sub <- nutclust.L7  %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('p.adj.log')) %>% pivot_wider(.,names_from = 'genus',values_from = 'estimate') %>%
column_to_rownames(.,'clusters') %>% data.matrix(.)
nutclust.L7.sub2 <- nutclust.L7 %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('estimate')) %>% pivot_wider(.,names_from = 'genus',values_from = 'p.adj.log') %>%
column_to_rownames(.,'clusters') %>% data.matrix(.)
nutclust.L7.sub2 <- ifelse(nutclust.L7.sub2 >= -log10(0.05),'*','')
nutclust.L7.U1.sub <- nutclust.L7.U1  %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('p.adj.log')) %>% pivot_wider(.,names_from = 'specy',values_from = 'estimate') %>%
column_to_rownames(.,'cluster') %>% data.matrix(.)
nutclust.L7.U1.sub2 <- nutclust.L7.U1 %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('estimate')) %>% pivot_wider(.,names_from = 'specy',values_from = 'p.adj.log') %>%
column_to_rownames(.,'cluster') %>% data.matrix(.)
nutclust.L7.U1.sub2 <- ifelse(nutclust.L7.U1.sub2 >= -log10(0.05),'*','')
nutclust.L7.U2.sub <- nutclust.L7.U2  %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('p.adj.log')) %>% pivot_wider(.,names_from = 'specy',values_from = 'estimate') %>%
column_to_rownames(.,'cluster') %>% data.matrix(.)
nutclust.L7.U2.sub2 <- nutclust.L7.U2 %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('estimate')) %>% pivot_wider(.,names_from = 'specy',values_from = 'p.adj.log') %>%
column_to_rownames(.,'cluster') %>% data.matrix(.)
nutclust.L7.U2.sub2 <- ifelse(nutclust.L7.U2.sub2 >= -log10(0.05),'*','')
##interesting taxa
#L6
nutclust.L6 <- nutclust.L6 %>% distinct(.)
nutclust.L6.sig <- nutclust.L6[grepl('_Actinomyces',nutclust.L6$genus) | grepl('_Streptomyces',nutclust.L6$genus) | grepl('Clostridiales._',nutclust.L6$genus)| grepl('Butyrivibrio',nutclust.L6$genus)| grepl('Bacteroides',nutclust.L6$genus),]
# nutclust.L6.sig <- nutclust.L6[nutclust.L6$estimate >= 0.2 | nutclust.L6$estimate <= -0.2,]
# nutclust.L6.sig <- nutclust.L6.sig[order(-nutclust.L6.sig$estimate ),][1:50,]
nutclust.L6.sig.sub <- nutclust.L6.sig %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('p.adj.log'))  %>% pivot_wider(.,names_from = 'genus',values_from = 'estimate') %>%
column_to_rownames(.,'clusters') %>% data.matrix(.)
nutclust.L6.sig.sub[is.na(nutclust.L6.sig.sub)] <- 0
nutclust.L6.sig.sub2 <- nutclust.L6.sig  %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('estimate'))%>% distinct(.) %>% pivot_wider(.,names_from = 'genus',values_from = 'p.adj.log') %>%
column_to_rownames(.,'clusters') %>% data.matrix(.)
nutclust.L6.sig.sub2 <- ifelse(nutclust.L6.sig.sub2 >= -log10(0.05),'*','')
##U1 sub of taxa
nutclust.L6.U1 <- nutclust.L6.U1 %>% distinct(.)
nutclust.L6.U1.sig <- nutclust.L6.U1[grepl('_Actinomyces',nutclust.L6.U1$genus) | grepl('_Streptomyces',nutclust.L6.U1$genus) | grepl('Clostridiales._',nutclust.L6.U1$genus)| grepl('Butyrivibrio',nutclust.L6.U1$genus)| grepl('Bacteroides',nutclust.L6.U1$genus),]
# nutclust.L6.U1.sig <- nutclust.L6.U1[nutclust.L6.U1$estimate >= 0.2 | nutclust.L6.U1$estimate <= -0.2,]
# nutclust.L6.U1.sig <- nutclust.L6.U1.sig[order(-nutclust.L6.U1.sig$estimate ),][1:50,]
nutclust.L6.U1.sig.sub <- nutclust.L6.U1.sig %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('p.adj.log'))  %>% pivot_wider(.,names_from = 'genus',values_from = 'estimate') %>%
column_to_rownames(.,'cluster') %>% data.matrix(.)
nutclust.L6.U1.sig.sub[is.na(nutclust.L6.U1.sig.sub)] <- 0
nutclust.L6.U1.sig.sub2 <- nutclust.L6.U1.sig  %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('estimate'))%>% distinct(.) %>% pivot_wider(.,names_from = 'genus',values_from = 'p.adj.log') %>%
column_to_rownames(.,'cluster') %>% data.matrix(.)
nutclust.L6.U1.sig.sub2 <- ifelse(nutclust.L6.U1.sig.sub2 >= -log10(0.05),'*','')
#U2 with subset of taxa
nutclust.L6.U2 <- nutclust.L6.U2 %>% distinct(.)
nutclust.L6.U2.sig <- nutclust.L6.U2[grepl('_Actinomyces',nutclust.L6.U2$genus) | grepl('_Streptomyces',nutclust.L6.U2$genus) | grepl('Clostridiales._',nutclust.L6.U2$genus)| grepl('Butyrivibrio',nutclust.L6.U2$genus)| grepl('Bacteroides',nutclust.L6.U2$genus),]
# nutclust.L6.U2.sig <- nutclust.L6.U2[nutclust.L6.U2$estimate >= 0.2 | nutclust.L6.U2$estimate <= -0.2,]
# nutclust.L6.U2.sig <- nutclust.L6.U2.sig[order(-nutclust.L6.U2.sig$estimate ),][1:50,]
nutclust.L6.U2.sig.sub <- nutclust.L6.U2.sig %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('p.adj.log'))  %>% pivot_wider(.,names_from = 'genus',values_from = 'estimate') %>%
column_to_rownames(.,'cluster') %>% data.matrix(.)
nutclust.L6.U2.sig.sub[is.na(nutclust.L6.U2.sig.sub)] <- 0
nutclust.L6.U2.sig.sub2 <- nutclust.L6.U2.sig  %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('estimate'))%>% distinct(.) %>% pivot_wider(.,names_from = 'genus',values_from = 'p.adj.log') %>%
column_to_rownames(.,'cluster') %>% data.matrix(.)
nutclust.L6.U2.sig.sub2 <- ifelse(nutclust.L6.U2.sig.sub2 >= -log10(0.05),'*','')
##interesting taxa
#L7
nutclust.L7 <- nutclust.L7 %>% distinct(.)
nutclust.L7.sig <- nutclust.L7[grepl('pallens',nutclust.L7$genus) | grepl('bacilliformis',nutclust.L7$genus)| grepl('faecis',nutclust.L7$genus)| grepl('bifidum',nutclust.L7$genus)| grepl('catus',nutclust.L7$genus)| grepl('_obeum',nutclust.L7$genus) ,]
# nutclust.L7.sig <- nutclust.L7[nutclust.L7$estimate >= 0.2 | nutclust.L7$estimate <= -0.2,]
# nutclust.L7.sig <- nutclust.L7.sig[order(-nutclust.L7.sig$estimate ),][1:50,]
nutclust.L7.sig.sub <- nutclust.L7.sig %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('p.adj.log'))  %>% pivot_wider(.,names_from = 'genus',values_from = 'estimate') %>%
column_to_rownames(.,'clusters') %>% data.matrix(.)
nutclust.L7.sig.sub[is.na(nutclust.L7.sig.sub)] <- 0
nutclust.L7.sig.sub2 <- nutclust.L7.sig  %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('estimate'))%>% distinct(.) %>% pivot_wider(.,names_from = 'genus',values_from = 'p.adj.log') %>%
column_to_rownames(.,'clusters') %>% data.matrix(.)
nutclust.L7.sig.sub2 <- ifelse(nutclust.L7.sig.sub2 >= -log10(0.05),'*','')
#U1 with sub of nutrients
nutclust.L7.U1 <- nutclust.L7.U1 %>% distinct(.)
nutclust.L7.U1.sig <- nutclust.L7.U1[grepl('pallens',nutclust.L7.U1$specy) | grepl('bacilliformis',nutclust.L7.U1$specy)| grepl('faecis',nutclust.L7.U1$specy)| grepl('bifidum',nutclust.L7.U1$specy)| grepl('catus',nutclust.L7.U1$specy)| grepl('_obeum',nutclust.L7.U1$specy) ,]
# nutclust.L7.U1.sig <- nutclust.L7.U1[nutclust.L7.U1$estimate >= 0.2 | nutclust.L7.U1$estimate <= -0.2,]
# nutclust.L7.U1.sig <- nutclust.L7.U1.sig[order(-nutclust.L7.U1.sig$estimate ),][1:50,]
nutclust.L7.U1.sig.sub <- nutclust.L7.U1.sig %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('p.adj.log'))  %>% pivot_wider(.,names_from = 'specy',values_from = 'estimate') %>%
column_to_rownames(.,'cluster') %>% data.matrix(.)
nutclust.L7.U1.sig.sub[is.na(nutclust.L7.U1.sig.sub)] <- 0
nutclust.L7.U1.sig.sub2 <- nutclust.L7.U1.sig  %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('estimate'))%>% distinct(.) %>% pivot_wider(.,names_from = 'specy',values_from = 'p.adj.log') %>%
column_to_rownames(.,'cluster') %>% data.matrix(.)
nutclust.L7.U1.sig.sub2 <- ifelse(nutclust.L7.U1.sig.sub2 >= -log10(0.05),'*','')
#U2 with sub of nutrients
nutclust.L7.U2 <- nutclust.L7.U2 %>% distinct(.)
nutclust.L7.U2.sig <- nutclust.L7.U2[grepl('pallens',nutclust.L7.U2$specy) | grepl('bacilliformis',nutclust.L7.U2$specy)| grepl('faecis',nutclust.L7.U2$specy)| grepl('bifidum',nutclust.L7.U2$specy)| grepl('catus',nutclust.L7.U2$specy)| grepl('_obeum',nutclust.L7.U2$specy) ,]
# nutclust.L7.U2.sig <- nutclust.L7.U2[nutclust.L7.U2$estimate >= 0.2 | nutclust.L7.U2$estimate <= -0.2,]
# nutclust.L7.U2.sig <- nutclust.L7.U2.sig[order(-nutclust.L7.U2.sig$estimate ),][1:50,]
nutclust.L7.U2.sig.sub <- nutclust.L7.U2.sig %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('p.adj.log'))  %>% pivot_wider(.,names_from = 'specy',values_from = 'estimate') %>%
column_to_rownames(.,'cluster') %>% data.matrix(.)
nutclust.L7.U2.sig.sub[is.na(nutclust.L7.U2.sig.sub)] <- 0
nutclust.L7.U2.sig.sub2 <- nutclust.L7.U2.sig  %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('estimate'))%>% distinct(.) %>% pivot_wider(.,names_from = 'specy',values_from = 'p.adj.log') %>%
column_to_rownames(.,'cluster') %>% data.matrix(.)
nutclust.L7.U2.sig.sub2 <- ifelse(nutclust.L7.U2.sig.sub2 >= -log10(0.05),'*','')
View(nutclust.L7.sig)
conv.L6.sub <- conv.L6  %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('p.adj.log')) %>% pivot_wider(.,names_from = 'genus',values_from = 'estimate') %>%
column_to_rownames(.,'clusters') %>% data.matrix(.)
conv.L6.sub2 <- conv.L6 %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('estimate')) %>% pivot_wider(.,names_from = 'genus',values_from = 'p.adj.log') %>%
column_to_rownames(.,'clusters') %>% data.matrix(.)
conv.L6.sub2 <- ifelse(conv.L6.sub2 >= -log10(0.05),'*','')
conv.L6.U1.sub <- conv.L6.U1  %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('p.adj.log')) %>% pivot_wider(.,names_from = 'genus',values_from = 'estimate') %>%
column_to_rownames(.,'clusters') %>% data.matrix(.)
conv.L6.U1.sub2 <- conv.L6.U1 %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('estimate')) %>% pivot_wider(.,names_from = 'genus',values_from = 'p.adj.log') %>%
column_to_rownames(.,'clusters') %>% data.matrix(.)
conv.L6.U1.sub2 <- ifelse(conv.L6.U1.sub2 >= -log10(0.05),'*','')
conv.L6.U2.sub <- conv.L6.U2  %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('p.adj.log')) %>% pivot_wider(.,names_from = 'genus',values_from = 'estimate') %>%
column_to_rownames(.,'clusters') %>% data.matrix(.)
conv.L6.U2.sub2 <- conv.L6.U2 %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('estimate')) %>% pivot_wider(.,names_from = 'genus',values_from = 'p.adj.log') %>%
column_to_rownames(.,'clusters') %>% data.matrix(.)
conv.L6.U2.sub2 <- ifelse(conv.L6.U2.sub2 >= -log10(0.05),'*','')
##L7
conv.L7.sub <- conv.L7  %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('p.adj.log')) %>% pivot_wider(.,names_from = 'specy',values_from = 'estimate') %>%
column_to_rownames(.,'clusters') %>% data.matrix(.)
conv.L7.sub2 <- conv.L7 %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('estimate')) %>% pivot_wider(.,names_from = 'specy',values_from = 'p.adj.log') %>%
column_to_rownames(.,'clusters') %>% data.matrix(.)
conv.L7.sub2 <- ifelse(conv.L7.sub2 >= -log10(0.05),'*','')
conv.L7.U1.sub <- conv.L7.U1  %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('p.adj.log')) %>% pivot_wider(.,names_from = 'specy',values_from = 'estimate') %>%
column_to_rownames(.,'cluster') %>% data.matrix(.)
conv.L7.U1.sub2 <- conv.L7.U1 %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('estimate')) %>% pivot_wider(.,names_from = 'specy',values_from = 'p.adj.log') %>%
column_to_rownames(.,'cluster') %>% data.matrix(.)
conv.L7.U1.sub2 <- ifelse(conv.L7.U1.sub2 >= -log10(0.05),'*','')
conv.L7.U2.sub <- conv.L7.U2  %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('p.adj.log')) %>% pivot_wider(.,names_from = 'specy',values_from = 'estimate') %>%
column_to_rownames(.,'clusters') %>% data.matrix(.)
conv.L7.U2.sub2 <- conv.L7.U2 %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('estimate')) %>% pivot_wider(.,names_from = 'specy',values_from = 'p.adj.log') %>%
column_to_rownames(.,'clusters') %>% data.matrix(.)
conv.L7.U2.sub2 <- ifelse(conv.L7.U2.sub2 >= -log10(0.05),'*','')
##interesting taxa
#L6
conv.L6 <- conv.L6 %>% distinct(.)
conv.L6.sig <- conv.L6[grepl('_Actinomyces',conv.L6$genus) | grepl('_Streptomyces',conv.L6$genus) | grepl('Clostridiales._',conv.L6$genus)| grepl('Butyrivibrio',conv.L6$genus)| grepl('Bacteroides',conv.L6$genus),]
# conv.L6.sig <- conv.L6[conv.L6$estimate >= 0.2 | conv.L6$estimate <= -0.2,]
# conv.L6.sig <- conv.L6.sig[order(-conv.L6.sig$estimate ),][1:50,]
conv.L6.sig.sub <- conv.L6.sig %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('p.adj.log'))  %>% pivot_wider(.,names_from = 'genus',values_from = 'estimate') %>%
column_to_rownames(.,'clusters') %>% data.matrix(.)
conv.L6.sig.sub[is.na(conv.L6.sig.sub)] <- 0
conv.L6.sig.sub2 <- conv.L6.sig  %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('estimate'))%>% distinct(.) %>% pivot_wider(.,names_from = 'genus',values_from = 'p.adj.log') %>%
column_to_rownames(.,'clusters') %>% data.matrix(.)
conv.L6.sig.sub2 <- ifelse(conv.L6.sig.sub2 >= -log10(0.05),'*','')
conv.L6.U1 <- conv.L6.U1 %>% distinct(.)
conv.L6.U1.sig <- conv.L6.U1[grepl('_Actinomyces',conv.L6.U1$genus) | grepl('_Streptomyces',conv.L6.U1$genus) | grepl('Clostridiales._',conv.L6.U1$genus)| grepl('Butyrivibrio',conv.L6.U1$genus)| grepl('Bacteroides',conv.L6.U1$genus),]
# conv.L6.U1.sig <- conv.L6.U1[conv.L6.U1$estimate >= 0.2 | conv.L6.U1$estimate <= -0.2,]
# conv.L6.U1.sig <- conv.L6.U1.sig[order(-conv.L6.U1.sig$estimate ),][1:50,]
conv.L6.U1.sig.sub <- conv.L6.U1.sig %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('p.adj.log'))  %>% pivot_wider(.,names_from = 'genus',values_from = 'estimate') %>%
column_to_rownames(.,'clusters') %>% data.matrix(.)
conv.L6.U1.sig.sub[is.na(conv.L6.U1.sig.sub)] <- 0
conv.L6.U1.sig.sub2 <- conv.L6.U1.sig  %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('estimate'))%>% distinct(.) %>% pivot_wider(.,names_from = 'genus',values_from = 'p.adj.log') %>%
column_to_rownames(.,'clusters') %>% data.matrix(.)
conv.L6.U1.sig.sub2 <- ifelse(conv.L6.U1.sig.sub2 >= -log10(0.05),'*','')
conv.L6.U2 <- conv.L6.U2 %>% distinct(.)
conv.L6.U2.sig <- conv.L6.U2[grepl('_Actinomyces',conv.L6.U2$genus) | grepl('_Streptomyces',conv.L6.U2$genus) | grepl('Clostridiales._',conv.L6.U2$genus)| grepl('Butyrivibrio',conv.L6.U2$genus)| grepl('Bacteroides',conv.L6.U2$genus),]
# conv.L6.U2.sig <- conv.L6.U2[conv.L6.U2$estimate >= 0.2 | conv.L6.U2$estimate <= -0.2,]
# conv.L6.U2.sig <- conv.L6.U2.sig[order(-conv.L6.U2.sig$estimate ),][1:50,]
conv.L6.U2.sig.sub <- conv.L6.U2.sig %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('p.adj.log'))  %>% pivot_wider(.,names_from = 'genus',values_from = 'estimate') %>%
column_to_rownames(.,'clusters') %>% data.matrix(.)
conv.L6.U2.sig.sub[is.na(conv.L6.U2.sig.sub)] <- 0
conv.L6.U2.sig.sub2 <- conv.L6.U2.sig  %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('estimate'))%>% distinct(.) %>% pivot_wider(.,names_from = 'genus',values_from = 'p.adj.log') %>%
column_to_rownames(.,'clusters') %>% data.matrix(.)
conv.L6.U2.sig.sub2 <- ifelse(conv.L6.U2.sig.sub2 >= -log10(0.05),'*','')
##interesting taxa
#L7
conv.L7 <- conv.L7 %>% distinct(.)
conv.L7.sig <- conv.L7[grepl('pallens',conv.L7$specy) | grepl('bacilliformis',conv.L7$specy)| grepl('faecis',conv.L7$specy)| grepl('bifidum',conv.L7$specy)| grepl('catus',conv.L7$specy)| grepl('_obeum',conv.L7$specy) ,]
# conv.L7.sig <- conv.L7[conv.L7$estimate >= 0.2 | conv.L7$estimate <= -0.2,]
# conv.L7.sig <- conv.L7.sig[order(-conv.L7.sig$estimate ),][1:50,]
conv.L7.sig.sub <- conv.L7.sig %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('p.adj.log'))  %>% pivot_wider(.,names_from = 'specy',values_from = 'estimate') %>%
column_to_rownames(.,'clusters') %>% data.matrix(.)
conv.L7.sig.sub[is.na(conv.L7.sig.sub)] <- 0
conv.L7.sig.sub2 <- conv.L7.sig  %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('estimate'))%>% distinct(.) %>% pivot_wider(.,names_from = 'specy',values_from = 'p.adj.log') %>%
column_to_rownames(.,'clusters') %>% data.matrix(.)
conv.L7.sig.sub2 <- ifelse(conv.L7.sig.sub2 >= -log10(0.05),'*','')
View(conv.L7.sig)
