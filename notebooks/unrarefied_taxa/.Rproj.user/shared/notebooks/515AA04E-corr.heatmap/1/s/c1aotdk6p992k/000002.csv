"0",""
"0","#only correlations not between 02. and -0.2,with p.vslue <= .05 sig. *"
"0","corr.nutr.L2.sig <- corr.nutr.L2[corr.nutr.L2$estimate >= 0.2 | corr.nutr.L2$estimate <= -0.2,]"
"0","# corr.nutr.L2.sig2 <- corr.nutr.L2[corr.nutr.L2$p.adj.log >= -log10(0.05),]"
"0",""
"0","corr.nutr.L6.sig <- corr.nutr.L6[corr.nutr.L6$estimate >= 0.2 | corr.nutr.L6$estimate <= -0.2,]"
"0","# corr.nutr.L6.sig2 <- corr.nutr.L6.sig[corr.nutr.L6.sig$p.adj.log >= -log10(0.05),]"
"0",""
"0","corr.nutr.family.sig <- corr.nutr.family[corr.nutr.family$estimate >= 0.2 | corr.nutr.family$estimate <= -0.2,]"
"0","# corr.nutr.family.sig2 <- corr.nutr.family.sig[corr.nutr.family.sig$p.adj.log >= -log10(0.05),]"
"0",""
"0","corr.nutr.L2.sig.sub <- corr.nutr.L2.sig %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('p.adj.log'))  %>% pivot_wider(.,names_from = 'phylum',values_from = 'estimate') %>%"
"0","  column_to_rownames(.,'nutrient') %>% data.matrix(.)"
"0","corr.nutr.L2.sig.sub[is.na(corr.nutr.L2.sig.sub)] <- 0"
"0",""
"0","corr.nutr.L2.sig.sub2 <- corr.nutr.L2.sig  %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('estimate'))%>% distinct(.) %>% pivot_wider(.,names_from = 'phylum',values_from = 'p.adj.log') %>%"
"0","  column_to_rownames(.,'nutrient') %>% data.matrix(.)"
"0","corr.nutr.L2.sig.sub2 <- ifelse(corr.nutr.L2.sig.sub2 >= -log10(0.05),'*','')"
"0",""
"0","corr.nutr.L6.sig.sub <- corr.nutr.L6.sig %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('p.adj.log'))  %>% pivot_wider(.,names_from = 'genus',values_from = 'estimate') %>%"
"0","  column_to_rownames(.,'nutrient') %>% data.matrix(.)"
"0","corr.nutr.L6.sig.sub[is.na(corr.nutr.L6.sig.sub)] <- 0"
"0",""
"0","corr.nutr.L6.sig.sub2 <- corr.nutr.L6.sig  %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('estimate'))%>% distinct(.) %>% pivot_wider(.,names_from = 'genus',values_from = 'p.adj.log') %>%"
"0","  column_to_rownames(.,'nutrient') %>% data.matrix(.)"
"0","corr.nutr.L6.sig.sub2 <- ifelse(corr.nutr.L6.sig.sub2 >= -log10(0.05),'*','')"
"0",""
"0","corr.nutr.family.sig.sub <- corr.nutr.family.sig %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('p.adj.log'))  %>% pivot_wider(.,names_from = 'taxa',values_from = 'estimate') %>%"
"0","  column_to_rownames(.,'nutrients') %>% data.matrix(.)"
"0","corr.nutr.family.sig.sub[is.na(corr.nutr.family.sig.sub)] <- 0"
"0",""
"0","corr.nutr.family.sig.sub2 <- corr.nutr.family.sig  %>% distinct(.) %>% dplyr::select(.,everything(),-starts_with('estimate'))%>% distinct(.) %>% pivot_wider(.,names_from = 'taxa',values_from = 'p.adj.log') %>%"
"0","  column_to_rownames(.,'nutrients') %>% data.matrix(.)"
"0","corr.nutr.family.sig.sub2 <- ifelse(corr.nutr.family.sig.sub2 >= -log10(0.05),'*','')"
"0",""
"0","my_palette <- colorRampPalette(c(""blue"", ""white"", ""red""))(n = 299)"
"0",""
"0","pdf(paste0(output_dir,'sig.corr.nutr.taxa'))"
"0","nutr.L2.sig <- heatmap.2(corr.nutr.L2.sig.sub,cexRow = .35,cexCol = .9,trace = 'none',key.title = 'Spearman correlation',col = my_palette,keysize = .5,key.par = list(cex=.4) ,notecol = 'black',srtCol = 30,cellnote = corr.nutr.L2.sig.sub2)"
