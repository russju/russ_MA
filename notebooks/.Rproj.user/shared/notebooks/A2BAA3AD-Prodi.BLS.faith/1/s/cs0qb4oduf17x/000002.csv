"0","##energy normalised stacked bar plot"
"0",""
"0","conv.clust <- subset(k.bls_prodi,select=c(`file_name`,`item_cat`,`Energie_bls`))#,`day`"
"0","# conv.clust$sample_day <- paste(conv.clust$file_name,conv.clust$day)"
"0","conv.clust <- as.data.frame(conv.clust)"
"0","conv.clust[is.na(conv.clust)] <- 0"
"0","conv.clust <- conv.clust[conv.clust$Energie_bls != 0, ]"
"0",""
"0","#sum of energy intake in one week"
"0",""
"0","conv.clust$energy_sum_cat <- with(conv.clust, ave(Energie_bls, file_name, item_cat, FUN = sum))"
"0",""
"0","conv.clust$energy_sum_total <- with(conv.clust, ave(Energie_bls, file_name, FUN = sum))"
"0",""
"0","conv.clust$percent <- (100/conv.clust$energy_sum_total)*conv.clust$energy_sum_cat"
"0","conv.clust <- subset(conv.clust,select = c(`file_name`,`item_cat`,`energy_sum_cat`,`energy_sum_total`,`percent`)) %>% unique(.)"
"0","conv.clust <- subset(conv.clust,select = c(`file_name`,`item_cat`,`percent`))"
"0",""
"0","conv <- tidyr::pivot_wider(conv.clust, names_from = item_cat, values_from = percent, values_fill = 0)"
"0",""
"0","#percentage stacked bar plots"
"0","##only U1"
"0",""
"0","conv.u1 <- conv[grepl(pattern = 'U1',conv$file_name), ]"
"0",""
"0","perc.u1 <- conv.u1 %>% "
"0","  pivot_longer(cols = -file_name) %>%"
"0","  ggplot(aes(x=file_name,y=value,fill=name)) + "
"0","  geom_bar(position=""fill"", stat=""identity"")+"
"0","  theme(axis.text = element_text(angle = 90)) +ggtitle('distribution of conventional clusters\nenergy normalised PRE samples')"
"0",""
"0","##only U2"
"0",""
"0","conv.u2 <- conv[grepl(pattern = 'U2',conv$file_name), ]"
"0",""
"0","perc.u2 <- conv.u2 %>% "
"0","  pivot_longer(cols = -file_name) %>%"
"0","  ggplot(aes(x=file_name,y=value,fill=name)) + "
"0","  geom_bar(position=""fill"", stat=""identity"")+"
"0","  theme(axis.text = element_text(angle = 90)) +ggtitle('distribution of conventional clusters\nenergy normalised keto samples')"
