"0","#deleting double samples "
"0","TF <- grepl(pattern = '.2U',x = row.names(div.L6))"
"0","L6.TF. <- cbind(div.L6,TF) %>% split(.,sub('\\d+','',`TF`))"
"0","div.L6 <- as.data.frame(L6.TF.[[""FALSE""]]) %>% dplyr::select(.,everything(),-ends_with('TF'))"
"0",""
"0","TF <- grepl(pattern = '.2U',x = row.names(div.L2))"
"0","L2.TF. <- cbind(div.L2,TF) %>% split(.,sub('\\d+','',`TF`))"
"0","div.L2 <- as.data.frame(L2.TF.[[""FALSE""]]) %>% dplyr::select(.,everything(),-ends_with('TF'))"
"0",""
"0","TF <- grepl(pattern = '.2U',x = row.names(div.fam))"
"0","fam.TF. <- cbind(div.fam,TF) %>% split(.,sub('\\d+','',`TF`))"
"0","div.fam <- as.data.frame(fam.TF.[[""FALSE""]]) %>% dplyr::select(.,everything(),-ends_with('TF'))"
"0",""
"0","#div.L6 U1"
"0","TF <- grepl(pattern = 'U1',x = row.names(div.L6))"
"0","L6.TF <- cbind(div.L6,TF)"
"0","L6.U1 <- split(L6.TF,sub('\\d+','',L6.TF$TF))"
"0","L6.U1 <- as.data.frame(L6.U1[[""TRUE""]])"
"0",""
"0","#div.L6 U2"
"0","TF <- grepl(pattern = 'U2',x = row.names(div.L6))"
"0","L6.TF <- cbind(div.L6,TF)"
"0","L6.U2 <- split(L6.TF,sub('\\d+','',L6.TF$TF))"
"0","L6.U2 <- as.data.frame(L6.U2[[""TRUE""]])"
"0",""
"0","#div.fam U1"
"0","TF <- grepl(pattern = 'U1',x = row.names(div.fam))"
"0","fam.TF <- cbind(div.fam,TF)"
"0","fam.U1 <- split(fam.TF,sub('\\d+','',fam.TF$TF))"
"0","fam.U1 <- as.data.frame(fam.U1[[""TRUE""]])"
"0",""
"0","#div.fam U2"
"0","TF <- grepl(pattern = 'U2',x = row.names(div.fam))"
"0","fam.TF <- cbind(div.fam,TF)"
"0","fam.U2 <- split(fam.TF,sub('\\d+','',fam.TF$TF))"
"0","fam.U2 <- as.data.frame(fam.U2[[""TRUE""]])"
"0",""
"0","#div.L2 "
"0","TF <- grepl(pattern = 'U1',x = row.names(div.L2))"
"0","L2.TF <- cbind(div.L2,TF)"
"0","L2.U1 <- split(L2.TF,sub('\\d+','',L2.TF$TF))"
"0","L2.U1 <- as.data.frame(L2.U1[[""TRUE""]])"
"0",""
"0","#div.L2"
"0","TF <- grepl(pattern = 'U2',x = row.names(div.L2))"
"0","L2.TF <- cbind(div.L2,TF)"
"0","L2.U2 <- split(L2.TF,sub('\\d+','',L2.TF$TF))"
"0","L2.U2 <- as.data.frame(L2.U2[[""TRUE""]])"
"0",""
"0","##L6 conv##"
"0","L6.sub <- rbind(L6.U1,L6.U2)"
"0","L2.sub <- rbind(L2.U1,L2.U2)"
"0","fam.sub <- rbind(fam.U1,fam.U2)"
"0",""
"0","row.names(L6.sub) <- str_replace(row.names(L6.sub),pattern = 'ST.',replacement = '') %>%  str_replace(.,pattern = '0U', replacement = 'U') "
"0","L6.sub$file_name <- str_replace(L6.sub$file_name,pattern = 'ST.',replacement = '') %>%  str_replace(.,pattern = '0U', replacement = 'U') "
"0",""
"0","merge.L6.biom.conv <- L6.sub %>% merge(.,conv.sum,by = 'file_name',all.x=T,all.y = T) "
"0",""
"0","merge.L6.biom.conv[is.na(merge.L6.biom.conv)] <- 0"
"0","merge.L6.biom.conv <- dplyr::select(merge.L6.biom.conv,everything(),-starts_with('TF')) %>%"
"0","  column_to_rownames(.,'file_name')"
"0",""
"0","##L2 conv##"
"0","row.names(L2.sub) <- str_replace(row.names(L2.sub),pattern = 'ST.',replacement = '') %>%  str_replace(.,pattern = '0U', replacement = 'U') "
"0","L2.sub$file_name <- str_replace(L2.sub$file_name,pattern = 'ST.',replacement = '') %>%  str_replace(.,pattern = '0U', replacement = 'U') "
"0",""
"0","merge.L2.biom.conv <- L2.sub %>% merge(.,conv.sum,by = 'file_name',all.x=T,all.y = T) "
"0",""
"0","merge.L2.biom.conv[is.na(merge.L2.biom.conv)] <- 0"
"0","merge.L2.biom.conv <- dplyr::select(merge.L2.biom.conv,everything(),-starts_with('TF')) %>%"
"0","  column_to_rownames(.,'file_name')"
"0",""
"0","##L2 conv U1"
"0","merge.L2.biom.conv.U1 <- fam.U1 %>% merge(.,conv.sum,by = 'file_name',all.x=T,all.y = T) "
"0",""
"0","merge.L2.biom.conv.U1[is.na(merge.L2.biom.conv.U1)] <- 0"
"0","merge.L2.biom.conv.U1 <- dplyr::select(merge.L2.biom.conv.U1,everything(),-starts_with('TF')) %>%"
"0","  column_to_rownames(.,'file_name')"
"0","##L2 conv U2"
"0","merge.L2.biom.conv.U2 <- fam.U2 %>% merge(.,conv.sum,by = 'file_name',all.x=T,all.y = T) "
"0",""
"0","merge.L2.biom.conv.U2[is.na(merge.L2.biom.conv.U2)] <- 0"
"0","merge.L2.biom.conv.U2 <- dplyr::select(merge.L2.biom.conv.U2,everything(),-starts_with('TF')) %>%"
"0","  column_to_rownames(.,'file_name')"
"0",""
"0","##L6 conv U1"
"0","merge.L6.biom.conv.U1 <- fam.U1 %>% merge(.,conv.sum,by = 'file_name',all.x=T,all.y = T) "
"0",""
"0","merge.L6.biom.conv.U1[is.na(merge.L6.biom.conv.U1)] <- 0"
"0","merge.L6.biom.conv.U1 <- dplyr::select(merge.L6.biom.conv.U1,everything(),-starts_with('TF')) %>%"
"0","  column_to_rownames(.,'file_name')"
"0","##L6 conv U2"
"0","merge.L6.biom.conv.U2 <- fam.U2 %>% merge(.,conv.sum,by = 'file_name',all.x=T,all.y = T) "
"0",""
"0","merge.L6.biom.conv.U2[is.na(merge.L6.biom.conv.U2)] <- 0"
"0","merge.L6.biom.conv.U2 <- dplyr::select(merge.L6.biom.conv.U2,everything(),-starts_with('TF')) %>%"
"0","  column_to_rownames(.,'file_name')"
"0",""
"0","##L6 nutr##"
"0","merge.L6.biom.nutr <- L6.sub %>% merge(.,cl.sum,by = 'file_name',all.x=T,all.y = T) "
"0",""
"0","merge.L6.biom.nutr[is.na(merge.L6.biom.nutr)] <- 0"
"0","merge.L6.biom.nutr <- dplyr::select(merge.L6.biom.nutr,everything(),-starts_with('TF')) %>%"
"0","  column_to_rownames(.,'file_name')"
"0",""
"0","##L2 nutr##"
"0","merge.L2.biom.nutr <- L2.sub %>% merge(.,cl.sum,by = 'file_name',all.x=T,all.y = T) "
"0",""
"0","merge.L2.biom.nutr[is.na(merge.L2.biom.nutr)] <- 0"
"0","merge.L2.biom.nutr <- dplyr::select(merge.L2.biom.nutr,everything(),-starts_with('TF')) %>%"
"0","  column_to_rownames(.,'file_name')"
"0",""
"0",""
"0","##L6 nutr U1"
"0","merge.L6.biom.nutr.U1 <- fam.U1 %>% merge(.,cl.sum,by = 'file_name',all.x=T,all.y = T) "
"0",""
"0","merge.L6.biom.nutr.U1[is.na(merge.L6.biom.nutr.U1)] <- 0"
"0","merge.L6.biom.nutr.U1 <- dplyr::select(merge.L6.biom.nutr.U1,everything(),-starts_with('TF')) %>%"
"0","  column_to_rownames(.,'file_name')"
"0","##L6 nutr U2"
"0","merge.L6.biom.nutr.U2 <- fam.U2 %>% merge(.,cl.sum,by = 'file_name',all.x=T,all.y = T) "
"0",""
"0","merge.L6.biom.nutr.U2[is.na(merge.L6.biom.nutr.U2)] <- 0"
"0","merge.L6.biom.nutr.U2 <- dplyr::select(merge.L6.biom.nutr.U2,everything(),-starts_with('TF')) %>%"
"0","  column_to_rownames(.,'file_name')"
"0","##L2 nutr U1"
"0","merge.L2.biom.nutr.U1 <- fam.U1 %>% merge(.,cl.sum,by = 'file_name',all.x=T,all.y = T) "
"0",""
"0","merge.L2.biom.nutr.U1[is.na(merge.L2.biom.nutr.U1)] <- 0"
"0","merge.L2.biom.nutr.U1 <- dplyr::select(merge.L2.biom.nutr.U1,everything(),-starts_with('TF')) %>%"
"0","  column_to_rownames(.,'file_name')"
"0","##L2 nutr U2"
"0","merge.L2.biom.nutr.U2 <- fam.U2 %>% merge(.,cl.sum,by = 'file_name',all.x=T,all.y = T) "
"0",""
"0","merge.L2.biom.nutr.U2[is.na(merge.L2.biom.nutr.U2)] <- 0"
"0","merge.L2.biom.nutr.U2 <- dplyr::select(merge.L2.biom.nutr.U2,everything(),-starts_with('TF')) %>%"
"0","  column_to_rownames(.,'file_name')"
"0",""
"0",""
"0","##family conv##"
"0","merge.L6.fam.conv <- fam.sub %>% merge(.,conv.sum,by = 'file_name',all.x=T,all.y = T)"
"0",""
"0","merge.L6.fam.conv[is.na(merge.L6.fam.conv)] <- 0"
"0","merge.L6.fam.conv <- dplyr::select(merge.L6.fam.conv,everything(),-starts_with('TF')) %>%"
"0","  column_to_rownames(.,'file_name')"
"0",""
"0","##family nutr##"
"0","cl.sum$file_name <- row.names(cl.sum)"
"0","merge.L6.fam.nutr <- fam.sub %>% merge(.,cl.sum,by = 'file_name',all.x=T,all.y = T)"
"0",""
"0","merge.L6.fam.nutr[is.na(merge.L6.fam.nutr)] <- 0"
"0","merge.L6.fam.nutr <- dplyr::select(merge.L6.fam.nutr,everything(),-starts_with('TF')) %>%"
"0","  column_to_rownames(.,'file_name')"
"0",""
"0","#family U1 conv"
"0","merge.U1.fam.conv <- fam.U1 %>% merge(.,conv.sum,by = 'file_name',all.x=T,all.y = T)"
"0",""
"0","merge.U1.fam.conv[is.na(merge.U1.fam.conv)] <- 0"
"0","merge.U1.fam.conv <- dplyr::select(merge.U1.fam.conv,everything(),-starts_with('TF')) %>%"
"0","  column_to_rownames(.,'file_name')"
"0",""
"0","#family U1 nutr"
"0","merge.U1.fam.nutr <- fam.sub %>% merge(.,cl.sum,by = 'file_name',all.x=T,all.y = T)"
"0",""
"0","merge.U1.fam.nutr[is.na(merge.U1.fam.nutr)] <- 0"
"0","merge.U1.fam.nutr <- dplyr::select(merge.U1.fam.nutr,everything(),-starts_with('TF')) %>%"
"0","  column_to_rownames(.,'file_name')"
"0",""
"0","#family U2 conv"
"0","merge.U2.fam.conv <- fam.sub %>% merge(.,conv.sum,by = 'file_name',all.x=T,all.y = T)"
"0",""
"0","merge.U2.fam.conv[is.na(merge.U2.fam.conv)] <- 0"
"0","merge.U2.fam.conv <- dplyr::select(merge.U2.fam.conv,everything(),-starts_with('TF')) %>%"
"0","  column_to_rownames(.,'file_name')"
"0",""
"0","#family U2 nutr"
"0","merge.U2.fam.nutr <- fam.sub %>% merge(.,cl.sum,by = 'file_name',all.x=T,all.y = T)"
"0",""
"0","merge.U2.fam.nutr[is.na(merge.U2.fam.nutr)] <- 0"
"0","merge.U2.fam.nutr <- dplyr::select(merge.U2.fam.nutr,everything(),-starts_with('TF')) %>%"
"0","  column_to_rownames(.,'file_name')"
"0",""
