"0","# # install.packages(""remotes"")"
"0","# # remotes::install_github(""taryue/GMDecomp"")"
"0","# "
"0","# #weighted UniFrac biplot"
"0","# "
"0","# biplot.pcoa(D = unifrac.nutr.w, x = pcoa_nutr.w, habillage = k.bls_prodi$Phenotype)"
"0","# "
"0","# #GMDecomp package"
"0","# "
"0","# #H:squared weighted UniFrac distance,similarity matrix for samples"
"0","# "
"0","# h <- unifrac.nutr.w^2"
"0","# h <- data.matrix(h)"
"0","# h <-  diag(1, dim(h)[2])"
"0","# "
"0","# #Q:similarity matrix for otus,any informative positive semi-definite matrix"
"0","# "
"0","# q <- diag(1, dim(otu.weighted)[2])"
"0","# otu.weighted <- as.data.frame(otu.weighted) %>% data.matrix(.)##remember:a df is never numeric!"
"0","# "
"0","# #K: screeplot displays top K GMD items"
"0","# "
"0","# unifrac.w.gmd <- GMD(X = otu.weighted, H = h, Q = q, K = 15)"
"0","# screeplot(unifrac.w.gmd )"
"0","# "
"0","# gmd.order = order(rowSums(unifrac.w.gmd$V[,1:2]^2), decreasing = T)"
"0","# plot.index = gmd.order[1:3]"
"0","# plot.names = colnames(otu.weighted)[plot.index]"
"0","# "
"0","# color <- row.names(otu.weighted) %>% as.data.frame(.)"
"0","# colnames(color) <- 'samples'"
"0","# color <- color %>%"
"0","#   mutate(col = case_when("
"0","#     samples == color$samples[grepl(color$samples,pattern = '.U1') == TRUE] ~ 'red',"
"0","#     samples == color$samples[grepl(color$samples,pattern = '.U2') == TRUE] ~ 'blue'))"
"0","# #not every color assignment worked?"
"0","# "
"0","# color <- transform(color, col=factor(substring(color$samples, 6), labels=c(""red"", ""blue"")))"
"0","# "
"0","# "
"0","# biplot(fit = unifrac.w.gmd, index = plot.index, names = plot.names, arrow.col = 'grey50',sample.col = color$col)"
"0",""
