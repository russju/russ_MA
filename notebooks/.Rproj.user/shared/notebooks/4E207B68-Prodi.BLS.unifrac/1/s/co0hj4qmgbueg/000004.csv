"0",""
"0",""
"0","#weighted UniFrac per day"
"0",""
"0","df.unifrac.samp <- subset(k.bls_prodi,select=c(`file_name`,`item`,`Energie_bls`,`Energie (kcal)`,`day`))"
"0",""
"0","##calculation for weighted UniFrac"
"0","df.unifrac.samp$calculation <- apply(X=df.unifrac.samp,MARGIN=2,FUN=function(line){(100/df.unifrac$`Energie_bls`)*df.unifrac$`Energie (kcal)`})"
"0","df.unifrac.samp <- as.data.frame(df.unifrac.samp)"
"0","df.unifrac.samp$sample_day <- paste(df.unifrac.samp$file_name,df.unifrac.samp$day)"
"0","df.unifrac.samp <- df.unifrac.samp[ ,-c(1)]"
"0",""
"0","#otu_table generation for weighted UniFrac"
"0","otu.unifrac.samp <- subset(df.unifrac.samp,select = c(`item`,`calculation`,`sample_day`))"
"0",""
"0","otu.unifrac.samp <- otu.unifrac.samp %>% group_by(item,sample_day) %>% summarize(sum = sum(calculation)) %>% pivot_wider(names_from = 'item',values_from = 'sum') %>% as.data.frame(.)"
"2","`summarise()` regrouping output by 'item' (override with `.groups` argument)
"
"0","otu.unifrac.samp[is.na(otu.unifrac.samp)] <- 0"
"0","row.names(otu.unifrac.samp) <- otu.unifrac.samp$sample_day"
"0","otu.unifrac.samp <- otu.unifrac.samp[ ,-1]"
"0",""
"0",""
"0","otu.weighted.samp <- otu_table(otu.unifrac.samp,taxa_are_rows = FALSE)"
"0",""
"0","phylo.conv.w.samp <- phyloseq(otu.weighted.samp,tree.conv)"
"0","unifrac.keto.conv.w.samp <- UniFrac(phylo.conv.w.samp,weighted = FALSE,fast = TRUE)"
"0","pcoa_keto.w.samp <- ape::pcoa(unifrac.keto.conv.w.samp)"
"0",""
"0","##visualization"
"0",""
"0","#Phenotype"
"0","p.metadata.conv.w.samp <- "
"0","  k.bls_prodi %>% "
"0","  dplyr::select(file_name:Phenotype) %>% "
"0","  distinct() %>% "
"0","  rename(Name = file_name)"
"0","pcoa_keto.w.samp$vectors %>%  ##error"
"0","  as.data.frame(.) %>% "
"0","  rownames_to_column('Name') %>% "
"0","  dplyr::select(Name, Axis.1:Axis.5) %>%"
"0","  separate(Name, remove = F, into = c('Sample','U'), sep = '[.]') %>% "
"0","  left_join(., p.metadata.conv.w.samp, by = 'Name') %>%"
"0","  mutate(Pheno = ifelse(Phenotype == 'not classified', NA, Phenotype)) %>% "
"0","  ggplot(aes(Axis.1, Axis.2)) + "
"0","  geom_point(aes(fill = U, alpha = Pheno),"
"0","    shape = 21, col = 'black', size = 4) + ggtitle('PcoA weighted UniFrac conventional clusters')"
"0",""
